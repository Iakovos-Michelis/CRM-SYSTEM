{% extends 'base_manager.html' %}

{% block title %}Manager Dashboard{% endblock %}

{% block content %}
    <div style="padding: 20px;">

        <!-- Page title -->
        <h1 style="text-align: center; margin-bottom: 30px;">MANAGER DASHBOARD</h1>

        <!-- Analytics grid -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
            
            <!-- Table 1: Contacts per Employee -->
            <div class="card" style="padding: 0; overflow: hidden;">
                <h4 style="background-color: rgba(27, 65, 255, 0.58); color: white; padding: 15px; margin: 0;">Contacts per Employee</h4>
                <table class="table" style="margin: 0;">
                    <thead>
                        <tr style="background-color: rgba(27, 65, 255, 0.58); color: white;">
                            <th>Employee Name</th>
                            <th>Contacts</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for emp in employees %}
                            <tr>
                                <td>{{ emp['username'] }}</td>
                                <td>{{ emp['contact_count'] }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Table 2: Customers Not Contacted -->
            <div class="card" style="padding: 0; overflow: hidden;">
                <h4 style="background-color: rgba(27, 65, 255, 0.58); color: white; padding: 15px; margin: 0;">Customers Not Contacted in 7 days</h4>
                <table class="table" style="margin: 0;">
                    <thead>
                        <tr style="background-color: rgba(27, 65, 255, 0.58); color: white;">
                            <th>Customer Name</th>
                            <th>Last Contact</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for cust in not_contacted %}
                            <tr>
                                <td>{{ cust['first_name'] }} {{ cust['last_name'] }}</td>
                                <td>{{ cust['last_contact_date'] }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Table 3: Customers Not Responding -->
            <div class="card" style="padding: 0; overflow: hidden;">
                <h4 style="background-color: rgba(27, 65, 255, 0.58); color: white; padding: 15px; margin: 0;">Customers Not Responding (3+ Contacts)</h4>
                <table class="table" style="margin: 0;">
                    <thead>
                        <tr style="background-color: rgba(27, 65, 255, 0.58); color: white;">
                            <th>Customer Name</th>
                            <th>Attempts</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for cust in not_responding %}
                            <tr>
                                <td>{{ cust['first_name'] }} {{ cust['last_name'] }}</td>
                                <td>{{ cust['interaction_count'] }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Table 4: Customers by Category -->
            <div class="card" style="padding: 0; overflow: hidden;">
                <h4 style="background-color: rgba(27, 65, 255, 0.58); color: white; padding: 15px; margin: 0;">Customers by Category</h4>
                <table class="table" style="margin: 0;">
                    <thead>
                        <tr style="background-color: rgba(27, 65, 255, 0.58); color: white;">
                            <th>Category</th>
                            <th>Count</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for cat in categories %}
                            <tr>
                                <td>{{ cat['status'] }}</td>
                                <td>{{ cat['count'] }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}